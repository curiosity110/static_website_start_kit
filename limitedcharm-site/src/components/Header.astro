---
import { getDictionary } from '../i18n/dict';
import { SUPPORTED_LANGUAGES } from '../i18n/config';
import type { Lang } from '../i18n/config';

interface Props { lang: Lang; }
const lang = Astro.props.lang;
const dict = getDictionary(lang) ?? {};
const nav = dict?.nav ?? {};
const path = Astro.url.pathname;
const suffix = path.replace(new RegExp(`^/${lang}`), '') || '/';
---

<header class="border-b">
  <div class="mx-auto flex max-w-screen-xl items-center justify-between p-4">
    <a href={`/${lang}/`} class="min-w-[44px] min-h-[44px] flex items-center focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2" aria-label="Home">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20" class="h-5 w-auto">
        <text x="0" y="15" font-size="15">Logo</text>
      </svg>
    </a>

    <nav class="hidden md:block" aria-label="Primary">
      <ul class="flex gap-4">
        <li><a class="block px-3 py-2" href={`/${lang}/`}>{nav?.home ?? 'Home'}</a></li>
        <li><a class="block px-3 py-2" href={`/${lang}/products`}>{nav?.products ?? 'Products'}</a></li>
        <li><a class="block px-3 py-2" href={`/${lang}/about`}>{nav?.about ?? 'About'}</a></li>
        <li><a class="block px-3 py-2" href={`/${lang}/faq`}>{nav?.faq ?? 'FAQ'}</a></li>
        <li><a class="block px-3 py-2" href={`/${lang}/contact`}>{nav?.contact ?? 'Contact'}</a></li>
      </ul>
    </nav>

    <div class="flex items-center gap-2">
      <!-- Language switcher dropdown -->
      <details class="relative">
        <summary class="list-none p-2 min-w-[44px] min-h-[44px] flex items-center justify-center focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2" aria-haspopup="true">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-6 w-6"><circle cx="12" cy="12" r="10" /><line x1="2" y1="12" x2="22" y2="12" /><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" /></svg>
          <span class="sr-only">Language</span>
        </summary>
        <ul class="absolute right-0 mt-2 bg-white shadow-lg rounded-md" role="menu">
          {SUPPORTED_LANGUAGES.map((l) => (
            <li><a href={`/${l}${suffix}`} class="block px-4 py-2 hover:bg-gray-100 focus:bg-gray-100" role="menuitem">{l.toUpperCase()}</a></li>
          ))}
        </ul>
      </details>

      <!-- Mobile menu -->
      <details class="md:hidden">
        <summary class="list-none cursor-pointer min-w-[44px] min-h-[44px] flex items-center justify-center focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2" class="h-6 w-6">
            <line x1="3" y1="6" x2="21" y2="6" />
            <line x1="3" y1="12" x2="21" y2="12" />
            <line x1="3" y1="18" x2="21" y2="18" />
          </svg>
          <span class="sr-only">Menu</span>
        </summary>
        <nav class="mt-2" aria-label="Mobile primary">
          <ul class="flex flex-col gap-2">
            <li><a class="block px-3 py-2" href={`/${lang}/`}>{nav?.home ?? 'Home'}</a></li>
            <li><a class="block px-3 py-2" href={`/${lang}/products`}>{nav?.products ?? 'Products'}</a></li>
            <li><a class="block px-3 py-2" href={`/${lang}/about`}>{nav?.about ?? 'About'}</a></li>
            <li><a class="block px-3 py-2" href={`/${lang}/faq`}>{nav?.faq ?? 'FAQ'}</a></li>
            <li><a class="block px-3 py-2" href={`/${lang}/contact`}>{nav?.contact ?? 'Contact'}</a></li>
          </ul>
        </nav>
      </details>
    </div>
  </div>
 </header>
